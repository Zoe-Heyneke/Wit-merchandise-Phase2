<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Checkout - Women in Tech</title>
  <link rel="stylesheet" href="styles.css"> <!-- your stylesheet -->
  <script src="https://kit.fontawesome.com/a2e0e6ad5f.js" crossorigin="anonymous"></script>
</head>
<body>
  <header>
    <a href="index.html">
        <img src="images/Logo_South Africa white.png" alt="Women in Tech" width="150" height="150">
    </a>
    <nav>
      <a href="index.html" class="underlined">Home</a>
      <a href="index.html#how-it-works">How it Works</a>
      <a href="products.html">Products</a>
      <a href="inspired.html">Get Inspired</a>
      <a href="cart.html"><i class="fa-solid fa-cart-shopping"></i></a> 
      <a href="profile.html"><i class="fa-solid fa-user"></i></a>
    </nav>
  </header>

  <main class="checkout-container">
    <!-- Order Summary -->
    <section class="order-summary">
      <h3>Order Summary</h3>
      <p><strong>Total Amount:</strong> R<span id="orderTotal">0.00</span></p>
      <a href= "cart.html" class="checkout-btn">View More...</a>
    </section>

    <!-- Shipping Section -->
    <div class="shipping-section">
      <h3>Shipping Address</h3>

      <label style="display:flex;align-items:center;gap:.5rem;margin-top:.5rem;">
        <input type="checkbox" id="useProfileAddress" checked>
        <span>Use profile address</span>
      </label>
      <div id="profileAddrPreview" class="addr-preview small-note">Loading your profile address…</div>
      <div id="profileAddrMissing" class="addr-preview addr-empty hidden">
        No address found in your profile. Untick “Use profile address” to enter a shipping address.
      </div>

      <!-- Alternate shipping form -->
      <div id="shippingForm" class="shipping-form">
        <div class="shipping-row">
          <input id="shipName" class="full" type="text" placeholder="Full Name">
          <input id="shipPhone" type="tel" placeholder="Phone Number">
          <input id="shipEmail" type="email" placeholder="Email">
          <input id="shipStreet" class="full" type="text" placeholder="Street">
          <select id="shipBuilding" >
            <option value="">Building Type</option>
            <option>Apartment</option>
            <option>House</option>
            <option>Complex</option>
            <option>Townhouse</option>
            <option>Office</option>
            <option>Other</option>
          </select>
          <input id="shipNeighborhood" type="text" placeholder="Neighborhood">
          <input id="shipCity" type="text" placeholder="City">
          <input id="shipPostal" type="text" placeholder="Postal Code">
        </div>
      </div>
    </div>

    <!-- Payment Options -->
    <section class="payment-options">
      <h3>Select Payment Method</h3>
      <select id="paymentMethod" onchange="showPaymentDetails()">
        <option value="" disabled selected>Choose a method</option>
        <option value="eft">EFT (Bank Transfer)</option>
        <option value="payfast">PayFast (Online Payment)</option>
      </select>

      <!-- EFT Box -->
      <div id="eft" class="payment-box" style="display:none;">
        <h4>EFT Payment</h4>
        <div id="paymentDetails">
        <h4>Bank Transfer Details</h4>
        <p><strong>Bank:</strong> First National Bank (FNB)</p>
        <p><strong>Account Name:</strong> South Africa Chapter Women in Tech NPC</p>
        <p><strong>Account Number:</strong> 62869256208</p>
        <p><strong>Branch Code:</strong> 201709</p>
        <p>Please send proof of payment to: <a href="mailto:melissa@women-in-tech.org">melissa@women-in-tech.org</a></p>
      
    </div>
      </div>

      <!-- PayFast Box -->
      <div id="payfast" class="payment-box" style="display:none;">
        <h4>PayFast Secure Payment</h4>
        <p>You’ll be redirected to PayFast to complete your payment securely.</p>
      </div>
    </section>

    <!-- Confirm Button -->
    <button onclick="proceedPayment()" class="checkout-btn">
      Confirm & Pay
    </button>
  </main>

  <footer>
    <div class="footer-container">
      <div class="footer-left">
        <a href="index.html">
          <img src="images/Logo_South Africa white.png" alt="Women in Tech" width="150" height="150">
        </a>
        <p>Empowering women in technology with confidence and excellence.​</p>
      </div>
      <div class="footer-links">
        <h3>Quick Links</h3>
        <a href="index.html">Home</a>
        <a href="index.html#how-it-works">How it Works</a>
        <a href="products.html">Products</a>
        <a href="inspired.html">Get Inspired</a>
        <a href="cart.html">Cart</a>
        <a href="profile.html">Profile</a>
      </div>
      <div class="footer-contact">
        <h3>Contact Us</h3>
        <p>
          Email: 
          <a href="mailto:south-africa@women-in-tech.org">south-africa@women-in-tech.org</a> 
          or 
          <a href="mailto:melissa@women-in-tech.org">melissa@women-in-tech.org</a>
        </p>
        <p>Address: South Africa</p>
      </div>
    </div>
  </footer>

  <script>
    // Example: Load total from localStorage or your cart script
    const orderTotal = localStorage.getItem("cartTotal") || "0.00";
    document.getElementById("orderTotal").innerText = orderTotal;

    function showPaymentDetails() {
      const method = document.getElementById("paymentMethod").value;
      document.querySelectorAll(".payment-box").forEach(box => box.style.display = "none");
      if (method) {
        document.getElementById(method).style.display = "block";
      }
    }

    function proceedPayment() {
      const method = document.getElementById("paymentMethod").value;
      if (!method) {
        alert("Please select a payment method.");
        return;
      }

      if (method === "eft") {
        alert("Order placed! Please EFT the total and send proof of payment.");
        // Save order + mark as pending
        window.location.href = "thankyou.html";
      }

      if (method === "payfast") {
        // Redirect to PayFast sandbox for now
        const payfastForm = document.createElement("form");
        payfastForm.method = "post";
        payfastForm.action = "https://sandbox.payfast.co.za/eng/process";

        const fields = {
          merchant_id: "10000100",
          merchant_key: "46f0cd694581a",
          return_url: window.location.origin + "/success.html",
          cancel_url: window.location.origin + "/cancel.html",
          notify_url: window.location.origin + "/notify.php",
          amount: orderTotal,
          item_name: "Women in Tech Order"
        };

        for (const key in fields) {
          const input = document.createElement("input");
          input.type = "hidden";
          input.name = key;
          input.value = fields[key];
          payfastForm.appendChild(input);
        }

        document.body.appendChild(payfastForm);
        payfastForm.submit();
      }
    }
  </script>
</body>
</html>
